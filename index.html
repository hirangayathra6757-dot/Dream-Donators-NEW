<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Dream Donators</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
    body {
        font-family: 'Poppins', sans-serif;
        margin: 0;
        background: #f5f7fa;
        color: #333;
    }
    nav {
        background: #4a6cf7;
        color: white;
        padding: 15px;
        text-align: center;
        font-size: 22px;
        font-weight: 600;
        box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }
    nav a {
        color: white;
        margin: 0 15px;
        text-decoration: none;
        font-weight: 400;
        cursor: pointer;
    }
    section {
        display: none;
        padding: 40px;
        animation: fade 0.6s ease;
    }
    @keyframes fade {
        from { opacity: 0; transform: translateY(15px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .active {
        display: block;
    }
    .card {
        background: white;
        padding: 25px;
        border-radius: 15px;
        max-width: 600px;
        margin: 40px auto;
        box-shadow: 0 2px 12px rgba(0,0,0,0.15);
    }
    input, textarea {
        width: 100%;
        padding: 12px;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        font-size: 16px;
    }
    button {
        background: #4a6cf7;
        color: white;
        padding: 12px 20px;
        border: none;
        border-radius: 10px;
        margin-top: 15px;
        cursor: pointer;
        font-size: 16px;
        width: 100%;
    }
    .admin-table {
        width: 90%;
        margin: 20px auto;
        border-collapse: collapse;
    }
    .admin-table th, .admin-table td {
        border: 1px solid #ccc;
        padding: 12px;
        background: white;
    }
</style>
</head>

<body>

<nav>
    Dream Donators
    <br>
    <a onclick="showPage('home')">Home</a>
    <a onclick="showPage('donate')">Donate</a>
    <a onclick="showPage('help')">Request Help</a>
    <a onclick="showPage('admin')">Admin</a>
</nav>

<!-- HOME -->
<section id="home" class="active">
    <div class="card">
        <h2>Welcome to Dream Donators</h2>
        <p>We help students in Sri Lanka who need uniforms, books, shoes & bags.</p>
        <p>Together we can make a difference ❤️</p>
    </div>
</section>

<!-- DONATE -->
<section id="donate">
    <div class="card">
        <h2>Register as a Donator</h2>
        <input id="donatorName" placeholder="Full Name">
        <input id="donatorPhone" placeholder="Phone Number">
        <input id="donatorItem" placeholder="What can you donate?">
        <button onclick="saveDonator()">Submit</button>
    </div>
</section>

<!-- HELP -->
<section id="help">
    <div class="card">
        <h2>Students – Request Help</h2>
        <input id="studentName" placeholder="Student Name">
        <input id="studentSchool" placeholder="School">
        <textarea id="studentNeed" placeholder="Explain what you need"></textarea>
        <button onclick="saveHelp()">Submit</button>
    </div>
</section>

<!-- ADMIN LOGIN -->
<section id="admin">
    <div class="card">
        <h2>Admin Login</h2>
        <input id="adminUser" placeholder="Username">
        <input id="adminPass" type="password" placeholder="Password">
        <button onclick="adminLogin()">Login</button>
    </div>
</section>

<!-- ADMIN DASHBOARD -->
<section id="dashboard">
    <div class="card">
        <h2>Admin Dashboard</h2>
        <p>Only visible to admin.</p>

        <h3>Donators</h3>
        <table class="admin-table" id="donatorsTable"></table>

        <h3>Students Requesting Help</h3>
        <table class="admin-table" id="helpTable"></table>
    </div>
</section>

<!-- Firebase -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs } 
        from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAVUIIwFXEsOmOS96lifn_aEccV3I35bWU",
        authDomain: "dream-donators.firebaseapp.com",
        projectId: "dream-donators",
        storageBucket: "dream-donators.firebasestorage.app",
        messagingSenderId: "943510265596",
        appId: "1:943510265596:web:25e49411973c046bf50179",
        measurementId: "G-KJ1WWR3TJH"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Save Donator
    window.saveDonator = async () => {
        await addDoc(collection(db, "donators"), {
            name: donatorName.value,
            phone: donatorPhone.value,
            item: donatorItem.value
        });
        alert("Thank you for donating!");
    };

    // Save Student Help Request
    window.saveHelp = async () => {
        await addDoc(collection(db, "students"), {
            name: studentName.value,
            school: studentSchool.value,
            need: studentNeed.value
        });
        alert("Your request has been sent.");
    };

    // Admin Login
    window.adminLogin = () => {
        if (adminUser.value === "Hiran" && adminPass.value === "Hiran@6757") {
            showPage("dashboard");
            loadData();
        } else {
            alert("Invalid login!");
        }
    };

    // Load Data into Dashboard
    async function loadData() {
        const donatorsSnap = await getDocs(collection(db, "donators"));
        const helpSnap = await getDocs(collection(db, "students"));

        let dHTML = "<tr><th>Name</th><th>Phone</th><th>Item</th></tr>";
        donatorsSnap.forEach(doc => {
            let x = doc.data();
            dHTML += `<tr><td>${x.name}</td><td>${x.phone}</td><td>${x.item}</td></tr>`;
        });
        donatorsTable.innerHTML = dHTML;

        let hHTML = "<tr><th>Name</th><th>School</th><th>Need</th></tr>";
        helpSnap.forEach(doc => {
            let x = doc.data();
            hHTML += `<tr><td>${x.name}</td><td>${x.school}</td><td>${x.need}</td></tr>`;
        });
        helpTable.innerHTML = hHTML;
    }

</script>

<script>
    function showPage(page) {
        document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
        document.getElementById(page).classList.add("active");
    }
</script>

</body>
</html>
